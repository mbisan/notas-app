<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editor</title>

    <script>
        window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true
        }
        };
    </script>
    <script id="MathJax-script"
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>

    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/hint/show-hint.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/edit/closebrackets.min.js" integrity="sha512-tsjcYO5hFvViRssxiM7Jhd8601epWOx1He3Hl4yuI5dKKPxr43KxkOhc9GZeeqzlYJm9ABb7UPA9697NiqZZ7Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/mode/overlay.min.js" integrity="sha512-SNwKDMYQwymOPjleeZy1xbdlK1PAjJ6EAplvx0CvNFJbW/pF5ec3h0mAdDl1yySq9r3Qont4STM4W3le7FTm9w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='spellcheck.css') }}">
    <script src="{{ url_for('static', filename='spellcheck.js') }}"></script>
    
    <!-- http://mozilla.github.io/nunjucks/getting-started.html -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/3.2.4/nunjucks.js" integrity="sha512-XWC7xjSwJ8DLAylsZft1S90HfKdaMn4b7apTYmYu1Q8E0jdKeJRQJEmvJX5kS08Bt8+uldKObLAM0FD0EsOJTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- hljs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/python.min.js" integrity="sha512-/uCTceIDOniHf+VUKbCnP/x6GQSRrm4GwUtQYMgKa9yIZPGzlR04flSsD+2or7bPn44VY9inIHI4cwNCcZmJDw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/sql.min.js" integrity="sha512-RzK8J6sL3xE7eyppcm7hjCq6fpW1kDlnKPO5jX+Z++/ChYXqsq5AoFq0z78g3jf/1DV5wMBZukqIyb+0xPkCVw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/bash.min.js" integrity="sha512-nQ9BQEzuov+Ry6EIH8ve7VKKdOG91Ix3SAQcFmOiBR5qG8sJONrph1InWTJOGjfP5QkSTSy4VnkEsPMoFYRsUQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- marked -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked-highlight@2.2.2/lib/index.umd.min.js"></script>

    <!-- luxon para las fechas -->
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.7.2/build/global/luxon.min.js"></script>
</head>
<body>

<div class="app-layout">
    <aside class="sidebar-left">
        <div class="sidebar-header">
            <h2 onclick="window.location.href = '/'">Notas</h2>
            <a href="{{ url_for('logout') }}" class="logout-btn">Salir</a>
        </div>
        <div id="file-tree">
            Loading...
        </div>
    </aside>

    <main class="main-content">
        <div id="note-header">
            <h1><div id="note-title" style="text-decoration: none; color: inherit;">Selecciona un fichero</div></h1>
            <div class="header-controls">
                <div class="control-btn" id="close-button" style="pointer-events: all;" title="Cerrar Nota" onclick="event.stopPropagation(); gotoDirectory()">‚ùå</div>
                <div class="control-btn" id="undo-button" style="pointer-events: none;" title="Deshacer" onclick="event.stopPropagation(); handleUndoAction()">‚Ü©Ô∏è</div>
                <div class="control-btn" id="redo-button" style="pointer-events: none;" title="Rehacer" onclick="event.stopPropagation(); handleRedoAction()">‚Ü™Ô∏è</div>
                <div class="control-btn" id="save-button" title="Guardar al disco" onclick="event.stopPropagation(); saveContent()">üíæ</div>
                <div class="control-btn" id="trash-button" title="Mover a la papelera" onclick="event.stopPropagation(); trashContent()">üóë</div>
            </div>
        </div>
        <div id="note-editor">
            <!-- Los bloques se renderizan aqui -->
        </div>
    </main>

    <aside class="sidebar-right">
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Buscar...">
            <div id="search-results"></div>
        </div>
        <div id="toc">
            <h3>Contenidos</h3>
            <ul id="toc-list"></ul>
        </div>
    </aside>
</div>

<script src="{{ url_for('static', filename='editor.js') }}"></script>
<script src="{{ url_for('static', filename='search.js') }}"></script>
</body>
</html>